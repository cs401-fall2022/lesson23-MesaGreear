extends layout

block content
  //-                    newPost editPost newCom  editCom
  - const popupIDs    = ["0_0_", "0_1_", "1_0_", "1_1_"]
  - const popupParams = ["0,0,", "0,1,", "1,0,", "1,1,"]

  h1= title
  p Welcome to #{title}

  //display an unordered list of every post in posts
  ul(class="postList")
    each post in posts_data 
      li 

        //handles the top of a post, i.e. the title and buttons
        div(class="postTop")

          //delete post button
          div
            form(action="/deletePost" method="POST")
              //- TODO: *
              input(name="deletePost" id=("post" + post.post_id + "Delete") value=post.post_id class="hidden" readonly)
              button(title="Delete Post" class="deleteButton")

          //edit post button
          div
            button(title="Edit Post" class="editButton" onclick=("openPopup(" + popupParams[1] + post.post_id + ")"))

            //- TODO: **
            //popup for editing
            div(class="popupContainer")
              div(class="unfocused" id=("unfocused" + popupIDs[1] + post.post_id) onclick=("closePopup(" + popupParams[1] + post.post_id + ")"))

              div(class="popuptext" id=("popup" + popupIDs[1] + post.post_id))
                form(action="/editPost" method="POST")
                  textarea(name="editText" id=("post" + post.post_id + "editText") cols="50", rows="10") #{post.post_txt}

                  //- TODO: *
                  input(name="editPost" id=("post" + post.post_id + "Edit") value=post.post_id class="hidden" readonly)
                  button Send Edit

                button(onclick=("closePopup(" + popupParams[1] + post.post_id + ")")) cancel

          //comment post button
          div
            button(title="Comment on this Post" class="commentButton" onclick=("openPopup(" + popupParams[0] + post.post_id + ")"))

            //- TODO: **
            //popup for commenting
            div(class="popupContainer")
              div(class="unfocused" id=("unfocused" + popupIDs[0] + post.post_id) onclick=("closePopup(" + popupParams[0] + post.post_id + ")"))

              div(class="popuptext" id=("popup" + popupIDs[0] + post.post_id))  
                form(action="/addComment" method="POST")
                  textarea(name="commentText" id=("post" + post.post_id + "commentText") cols="50", rows="10") New comment text here!
                  //- TODO: *
                  input(name="commentPost" id=("post" + post.post_id + "Comment") value=post.post_id class="hidden" readonly)
                  button Send Comment

                button(onclick=("closePopup(" + popupParams[0] + post.post_id + ")")) cancel

          h2(class="postTitle") #{post.post_id} - Temp Title

        p #{post.post_txt}

        //display an unordered list of every comment in comments that has a post_id
        //that matches the post_id of the post it will be rendered underneath
        ul(class="commentList")
          each comment in comments_data 
            if comment.post_id == post.post_id
              li 

                //handles the top of a comment, i.e. the buttons
                div(class="commentTop")

                  //delete comment button
                  div
                    form(action="/deleteComment" method="POST")
                      //TODO: *
                      input(name="deleteComment" id=("comment" + comment.comment_id + "Delete") value=comment.comment_id class="hidden" readonly)
                      button(title="Delete Comment" class="deleteButton")

                  //edit comment button
                  div
                    form(action="/" method="POST")
                      //- TODO: *
                      input(name="editPost" id=("comment" + comment.comment_id + "Edit") value=comment.comment_id class="hidden" readonly)
                      button(title="Edit Comment" class="editButton")

                  //- TODO
                  h3(class="postTitle") #{comment.comment_id}

                p #{comment.comment_txt}
  
  //how to add a new post to posts
  h2 New Post!
  form(action="/addPost" method="POST")
        label(for="postText") Post text goes here! =>
        input(name="postText" id="postText" value="New post text here!")
        button Send my post

  //- * - This solution is like, really bad. I however cannot find any other way at the moment to send the post_id/comment_id of the
  //-     post/comment to index.js except for creating a hidden input with a set, unchanging value that equals post_id/comment_id

  //- * - There's a lot of repeating code for popups and although it works, I would like to see if I could minimize the amount of
  //-     repetitive code when it comes to popups in the future